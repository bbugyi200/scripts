#!/bin/bash

socket_name="$(tm-socket)"

if [[ -n "$socket_name" ]]; then
    SESSION_NAME=$(tmux -L "$socket_name" display-message -p "#S")
    N=$(tmux -L "$socket_name" ls | wc -l)

    if [[ "$N" -gt 1 ]]; then
        tmux -L "$socket_name" confirm-before -p "Confirm 'kill-session'? (y/n)" " switch-client -n; kill-session -t $SESSION_NAME"
    else
        tmux -L "$socket_name" confirm-before -p "Confirm 'kill-session'? (y/n)" "kill-session -t $SESSION_NAME"
    fi
else
    exit 1
fi
