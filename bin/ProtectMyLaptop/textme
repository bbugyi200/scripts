#!/bin/python
import sys
import os
import configparser

from twilio.rest import Client

configPath = os.path.expanduser('~/.PML.conf')
if os.path.isfile(os.path.expanduser('~/.config/PML.conf')):
    configPath = os.path.expanduser('~/.config/PML.conf')

config = configparser.ConfigParser()
config.read(configPath)

account_sid = config.get('Twilio', 'account_sid')
auth_token = config.get('Twilio', 'auth_token')
to = config.get('Twilio', 'to')
from_ = config.get('Twilio', 'from_')

try:
    body = sys.argv[1]
except IndexError as e:
    print("usage: " + os.path.basename(__file__) + " <body>")
    sys.exit(1)


if __name__ == "__main__":
    client = Client(account_sid, auth_token)
    message = client.api.account.messages.create(to=to,
                                                 from_=from_,
                                                 body=body)
