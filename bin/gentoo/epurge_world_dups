#!/bin/bash

################################################################
#  Removes packages from @world that already exist in @shared  #
################################################################

DUPLICATES="$(comm -12 <(sudo cat /etc/portage/sets/shared) <(sudo cat /var/lib/portage/world) 2> /dev/null)"

if [[ -z "$DUPLICATES" ]]; then
    echo "The @world and @shared sets do not intersect."
    exit 0
fi

for pkg in ${DUPLICATES}; do
    confirm "sudo sed -i '\|$pkg|d' /var/lib/portage/world"
done
