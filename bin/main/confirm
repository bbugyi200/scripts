#!/bin/bash

eval set -- $(getopt -o 'd' -l 'debug,dmenu' -- "$@")

action='read'
while [[ -n "$1" ]]; do
	case $1 in
		'--dmenu' )
			action='dmenu';;
        '-d' | '--debug' )
            debug=true;;
		'--' )
			shift
			break;;
	esac	
	shift
done

if [[ "$debug" = true ]]; then
    PS4='$LINENO: '
    set -x
fi

prompt="Do you really want to run \"$*\"? (y/n):"

case $action in
	'dmenu' )
		choice="$(echo | dmenu -p "$prompt")";;
	'read' )
		read -n 1 -p "$prompt " choice;;
esac

if [[ "$choice" == "y" ]]; then
	printf "\nrunning: \"$*\"\n\n"
	eval "$*"
	exit 0
else
	clear
	exit 1
fi
