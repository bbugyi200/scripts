#!/usr/bin/env python

import argparse
import subprocess

description = "Proxy script for Taskwarrior `task` command."

parser = argparse.ArgumentParser(description=description)
parser.add_argument('command', nargs='?', default='add')
parser.add_argument('-p', dest='project', default='', help='project')
parser.add_argument('-d', dest='due', default='', help='due date')
parser.add_argument('-s', dest='scheduled', default='', help='scheduled date')
parser.add_argument('-D', dest='depends', default='', help='dependency')
parser.add_argument('-r', dest='recur', default='', help='recurring interval')
parser.add_argument('-u', dest='until', default='', help='date to stop recurring')
parser.add_argument('-w', dest='wait', default='', help='wait date')
parser.add_argument('-t', dest='tag', default='', help='tag')
parser.add_argument('args', nargs=argparse.REMAINDER)

args = parser.parse_args()
print(args)

options = []
for opt in ['project', 'due', 'scheduled', 'depends', 'recur', 'until', 'wait', 'tag']:
    arg = getattr(args, opt)
    if arg:
        options.append(opt + ':{}'.format(arg))

print('task {command} {options} {args}'.format(command=args.command,
                                        options=' '.join(options),
                                        args=' '.join(args.args)))

subprocess.call(['task',
    args.command,
    *options,
    *args.args])
