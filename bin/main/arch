#!/usr/bin/env python

""" Archive Utility. Used to Archive and Compress Local Files/Directories. """

import argparse
from enum import Enum, auto
import subprocess as sp


class Action(Enum):
    """ Action Flags """
    ARCHIVE = auto()
    COMPRESS = auto()
    EXTRACT = auto()


def archive():
    """ Archive Items """
    for item in args.items:
        sp.call(['mv', item, 'archive/'])


def compress():
    """ Compress Archive Folder """
    sp.check_call(['tar', 'czvf', '.archive.tar.gz', 'archive'])
    sp.call(['rm', '-rf', 'archive'])


def extract():
    """ Extract Archive Folder """
    sp.check_call(['tar', 'xzvf', '.archive.tar.gz'])
    sp.call(['rm', '-f', '.archive.tar.gz'])


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description=__doc__)
    parser.add_argument('items', nargs=argparse.REMAINDER, help='File(s) or directory(s) to archive.')
    group = parser.add_mutually_exclusive_group()
    group.add_argument('-c', dest='action', action='store_const', const=Action.COMPRESS, help='Compress archive folder.')
    group.add_argument('-x', dest='action', action='store_const', const=Action.EXTRACT, help='Extract archive folder.')
    group.set_defaults(action=Action.ARCHIVE)
    args = parser.parse_args()

    {Action.ARCHIVE: archive,
     Action.COMPRESS: compress,
     Action.EXTRACT: extract}[args.action]()
