#!/bin/python
import os
import sys
from dateutil.parser import parse
from datetime import datetime


if sys.argv[1] == "--update":
    cmd_output = os.popen('grep -e ".*starting full.*" /var/log/pacman.log | tail -1 | cut -d "[" -f2 | cut -d "]" -f1')
    date_str = cmd_output.read().rstrip()
    last_updt = parse(date_str)
    delta = datetime.today() - last_updt
    days = delta.days


elif sys.argv[1] == "--cleanup":
    try:
        date_str = open('/home/bryan/.local/share/cleanup/timestamp', 'r').read().rstrip()
        last_clean = parse(date_str)
        delta = datetime.today() - last_clean
        days = delta.days
    except FileNotFoundError:
        days = 99999


print(days)
