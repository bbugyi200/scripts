#!/bin/bash

######################################
#  Runs System Maintenance Commands  #
######################################

confirm "egenerate_mirrors"
confirm "sudo emerge --sync"
confirm "sudo emerge --ask --update --deep --newuse @world" && notify-send "$(basename "$0")" "Full system update is complete."
confirm "sudo emerge --ask --depclean"
confirm "sudo revdep-rebuild"

xprint -D 2 "\n----- Checking local overlay repositories for new versions -----\n"
confirm "emanage -e"

# ---------- Write timestamp to file ----------
DATA_DIR=/home/bryan/.local/share/"$(basename "$0")"
[[ -d $DATA_DIR ]] || mkdir "$DATA_DIR"

TIMESTAMP_FILE=$DATA_DIR/timestamp
date +"%m/%d/%y" > "$TIMESTAMP_FILE"
