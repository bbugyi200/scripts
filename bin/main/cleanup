#!/bin/bash

######################################################################
#  Runs periodic maintenance tasks meant to cleanup the filesystem.  #
######################################################################

########## Maintenance Tasks
confirm "sudo pacman -Rns $(pacman -Qtdq | paste -sd " " -)"

confirm "sudo paccache -r"

confirm "sort_qb_quickmarks"

xtype -x "ls -a ~/.local/share/Trash/files"
confirm "rm -rf ~/.local/share/Trash/files/*"

xtype -x "ls -a ~/Downloads"
confirm "safe-rm -rf ~/Downloads/*"

xtype -x "ls -a /var/tmp/*.log"
confirm "safe-rm /var/tmp/*.log"

xtype -D 2 "\nTmuxinator sessions that have not been used in over 60 days:\n"
find /home/bryan/.config/tmuxinator/ -type f -name "*.yml" -atime +60 -execdir confirm "safe-rm {}" ";"

xtype -D 3 "\nCleanup your package manager by manually uninstalling any foreign packages that you are no longer using.\n"
xtype -x -D 10 "pacman -Qm | less"

########## Write timestamp to file
DATA_DIR=/home/$USER/.local/share/"$(basename "$0")"
[[ -d $DATA_DIR ]] || mkdir "$DATA_DIR"

TIMESTAMP_FILE=$DATA_DIR/timestamp
date +"%m/%d/%y" > "$TIMESTAMP_FILE"
